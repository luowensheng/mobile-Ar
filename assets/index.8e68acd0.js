import{P as F,O as _,M as $,V as z,R as A,t as D,G as R,a as G,S as H,A as W,W as B,D as q,T as I,C as Y,B as j,b as N,c as U,d as X}from"./vendor.666984d4.js";const K=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}};K();async function k(e){return await navigator.permissions.query({name:e})==="granted"}function V(e=["accelerometer","magnetometer","gyroscope"],t={frequency:60,referenceFrame:"device"}){const n=new AbsoluteOrientationSensor(t);let r=!0;if(e.forEach(o=>{k(o)||Z(o),k(o)||(alert("No permissions to use AbsoluteOrientationSensor."),r=!1)}),!r){alert("No permissions to use AbsoluteOrientationSensor.");return}return n.start(),n}function Z(e){navigator.permissions.query({name:e}).then(t=>{t.state==="denied"?alert("Permission to use "+e+" sensor is denied."):alert("Permission to use "+e+" sensor is accepted with "+t.state)})}function J(e){navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(t=>{e.srcObject=t,e.play(),console.log("webcam is on")}).catch(t=>{console.log("Something went wrong!",t)})}function Q(e){}const ee={gltf:se};function te(e,t,n){const r=(h,f)=>(h-t[f])/(n[f]-t[f]),o=e.clientX||e.touches[0].clientX,i=e.clientY||e.touches[0].clientY,c=r(o,"x")*2-1,p=-1*(r(i,"y")*2-1);return new z(c,p)}function ne(e){const{left:t,right:n,top:r,bottom:o}=e.domElement.getBoundingClientRect();return[{x:t,y:r},{x:n,y:o}]}class oe{constructor(t,n,r){this.map=new Map,this.scene=t,this.camera=n,this.renderer=r}Tick(){const t=this.map,n=this.camera,r=this.scene,o=this.renderer;return i=>{const[c,p]=ne(o),h=te(i,c,p),f=new A;f.setFromCamera(h,n);const w=f.intersectObjects(r.children,!0);if(w.length>0){let m=w[0].object;for(;m.parent&&!m.userData.clickable;)m=m.parent;if(m.userData.clickable&&m===m){let y=m.mname;if(t.has(y)){t.get(y)();return}}}t.get("background")()}}RegisterObject(t,n=()=>{}){this.map.set(t,n)}UnregisterObject(t){this.map.delete(t)}}function re(e,t){return new _(e,t)}async function ie(e,t,n="gltf"){try{ee[n](e,t)}catch{alert(`failed loading model of extenstion .${n}`)}}function se(e,t){new D.THREEGLTFLoader().load(e,r=>{t(r.scene)},r=>{},r=>{alert(`loadGLTF error loading ${e}: ${r}`),console.log(`loadGLTF error loading ${e}: ${r}`)})}function ae(e=75,t=window.innerWidth/window.innerHeight,n=.1,r=1e3){return new F(e,t,n,r)}function ce({objGeometry:e,objMaterial:t}){return new $(e,t)}const b=new R;b.add({item:"item"},"Models",{item1:"item1",item2:"item2"});b.windows=[];const P=innerWidth,x=innerHeight,de="./img.png",S=["black_leather_chair.gltf","Books_Magazines.gltf","Broken Container.gltf","Cappuccino_cup.glb","Dream AP2.glb","free_car_001.gltf","HepBurn_Sofa.glb","lesson1.glb","PEACE_LILLY_5K.gltf","SHOE_CABINET.gltf","TREE_STUMP_CARVED_5K.gltf","WHISKEY_GLTF.gltf","WoodHouse.glb"],C=S[Math.floor(Math.random()*S.length)];window.addEventListener("DOMContentLoaded",()=>{var e,t,n,r,o,i;const c=new G,p=new Y,h=document.createElement("canvas"),f=document.createElement("video");f.width=P,f.height=x;let w;const m=V();m.addEventListener("reading",()=>{c.quaternion.fromArray(m.quaternion).invert()}),J(f),O();const y=re(t,n.domElement);E();function E(){y.update(),e.background.needsUpdate=!0,n.render(e,t),T(),requestAnimationFrame(E)}function O(){e=new H;const s=new W(50);c.add(s),t=ae(),t.position.z=5,n=new B({alpha:!0}),n.setSize(P,x),document.body.appendChild(n.domElement);const d=new oe(e,t,n);d.RegisterObject("background",()=>{});const l=(a,g=5)=>{a.position.set(0,0,-15);const L=new X().setFromObject(a);a.scale.set(1/(L.max.x/g),1/(L.max.y/g),1/(L.max.z/g)),a.rotation.x=90*Math.PI/180};ie("./objects/"+C,a=>{l(a),a.mname=le(C),c.add(a),a.userData.clickable=!0;const g=ce({objGeometry:new j(1,1,1),objMaterial:new N({map:new U().load(de)})});c.add(g),d.RegisterObject(a.mname,()=>{console.log(`${a.mname} ${a}`),ue(a)}),document.addEventListener("click",d.Tick()),document.addEventListener("touchstart",d.Tick()),console.log("added click action for ",a),console.log("children: ",c.children)},"gltf");const u=new q(16777215,5);u.target=c,u.position.set(0,0,10),e.add(u),e.background=new I(h),e.add(c)}function T(){var s=h.getContext("2d");const d=`<${Math.floor(r)}, ${Math.floor(o)}, ${Math.floor(i)}>`;let l=20,u=20;const a=g=>g>0?"true":g==0?"\u{1F44C}":"false";s.drawImage(f,0,0,h.width,h.height),w!=null&&(fe(s,l-5,u-15,50,55),v(s,d,l,u-5),v(s,`X: ${a(Math.sign(r))}`,l,u+5),v(s,`Y: ${a(Math.sign(o))}`,l,u+15),v(s,`Z: ${a(Math.sign(i))}`,l,u+25))}window.addEventListener("devicemotion",s=>{p.getDelta();let d=-.01,l=.5,u=M(s.acceleration.x,l,d),a=M(s.acceleration.y,l+.2,d),g=M(s.acceleration.z,l,d);c.position.x+=u,c.position.y+=a,c.position.z+=g,r=u,o=a,i=g}),window.addEventListener("resize",()=>{t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),n.setSize(window.innerWidth,window.innerHeight)}),window.addEventListener("deviceorientation",s=>{w=s.absolute});function M(s,d,l){return Math.abs(s)>d?Math.floor(s)/d*l:0}function v(s,d,l,u,a="white"){s.strokeStyle=a,s.font="9px Arial",s.fillStyle=a,s.beginPath(),s.fillText(d,l,u),s.stroke()}window.addEventListener("resize",Q)});function le(e){return e.split(".")[0].split("_").join(" ")}function ue(e){const t=e.mname||`object ${e.uuid}`||"object";var n=b.addFolder(t),r=n.addFolder("position"),o=n.addFolder("rotation"),i=n.addFolder("scale");r.add(e.position,"x",-10,10),r.add(e.position,"y",-10,10),r.add(e.position,"z",-10,10),o.add(e.rotation,"x",-90,90),o.add(e.rotation,"y",-90,90),o.add(e.rotation,"z",-90,90),i.add(e.scale,"x",0,10),i.add(e.scale,"y",0,10),i.add(e.scale,"z",0,10),n.open(),r.open(),o.open(),i.open(),b.windows.push(n)}function fe(e,t,n,r,o,i="blue"){e.strokeStyle=i,e.font="10px Arial",e.fillStyle=i,e.beginPath(),e.rect(t,n,r,o),e.fill(),e.stroke()}
